package cve

import (
	"fmt"

	"github.com/csye7125-su24-team06/webapp-cve-processor/internal/models"
)

type KafkaProducer interface {
	Produce(cve *models.Cve) error
}

type kafkaProducer struct {
	count int
}

func NewKafkaProducer() KafkaProducer {
	return &kafkaProducer{}
}

func (k *kafkaProducer) Produce(cve *models.Cve) error {
	k.count++

	if k.count%10000 == 0 {
		fmt.Printf("Produced %d cves. Last CveId: %v\n", k.count, cve.Cve_id)
	}
	return nil
}
