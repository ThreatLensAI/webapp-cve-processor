package cve

import (
	"fmt"
	"time"
)

func parseDatePublished(updated string, published string) time.Time {
	var dateUpdated time.Time
	if len(updated) == 0 {
		updated = published
	}

	timeLayouts := []string{
		"2006-01-02T15:04:05",
		"2006-01-02T15:04:05Z",
		"2006-01-02T15:04:05.000Z",
	}

	var timeParseErr error
	for _, layout := range timeLayouts {
		dateUpdated, timeParseErr = time.Parse(layout, updated)
		if timeParseErr == nil {
			break
		}
	}

	if timeParseErr != nil {
		panic(fmt.Sprintf("Error Parsing Time : %v", timeParseErr))
	}

	return dateUpdated.UTC()
}
