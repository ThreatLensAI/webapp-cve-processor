package repository

import (
	"webapp-cve-processor/internal/models"
	"webapp-cve-processor/pkg/database"

	"gorm.io/gorm"
)

func InsertCve(cveDoc *models.Cve) {
	database.DataSource.Create(&cveDoc)
}

func FindCves(cveId string) (models.Cve, *gorm.DB) {
	var cveDoc models.Cve
	gormTx := database.DataSource.Where("cve_id = ?", cveId).Order("date_updated DESC").Limit(1).First(&cveDoc)
	return cveDoc, gormTx
}
