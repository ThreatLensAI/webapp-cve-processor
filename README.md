# CSYE7125 CVE Processor webapp

This repository contains the code for the CVE Processor webapp. The application fetches the latest CVE data from the NVD database and inserts it into the database.

## Prerequisites

To build and deploy the application locally, you will need the following:

- [Go](https://golang.org/doc/install) (version 1.22 or later)
- [Docker](https://docs.docker.com/get-docker/)
- [PostgreSQL](https://www.postgresql.org/download/) (version 15 or later)
- [Kafka](https://kafka.apache.org/quickstart) (version 3.0.0 or later)

## Build and Deploy Instructions

### Set Environment Variables

Before building and running the application, you need to set the following environment variables:

```bash
# Kafka Configuration
export KAFKA_BROKERS="localhost:9092,localhost:9093,localhost:9094" # Defaults to localhost:9092,localhost:9093,localhost:9094
export KAFKA_TOPIC="cve"                                            # Defaults to cve

# Kafka Leader Configuration
export KAFKA_PRIMARY="localhost:9092"              # Optional - Defaults to first broker in KAFKA_BROKERS
export KAFKA_NETWORK="tcp"                         # Optional - Defaults to tcp

# Kafka Scram SHA-512 Credentials (Skips auth if not provided)
export KAFKA_USERNAME=""                           # Optional - Defaults to ""
export KAFKA_PASSWORD=""                           # Optional - Defaults to ""

# Kafka Producer Configuration
export KAFKA_MAX_SIZE="1000000"                    # Optional - Defaults to 1000000
export KAFKA_BATCH_SIZE="1000"                     # Optional - Defaults to 1000
export KAFKA_BATCH_TIMEOUT_MILLIS="10"             # Optional - Defaults to 10

# Kafka Create Topic Configuration
export KAFKA_TOPIC_PARTITIONS="3"                  # Optional - Defaults to 3
export KAFKA_TOPIC_REPLICATION_FACTOR="3"          # Optional - Defaults to 3
```

### Build and Run the Application

To build the application, execute the following command:

```bash
go build -o cve-processor cmd/main.go
```

To run the application, execute the following command:

```bash
./cve-processor
```

### Application Details

The application will:

- Download the CVE list and process all JSON files in all directories.
- Creates a topic `KAFKA_TOPIC` in Kafka with the specified number of partitions and replication factor if not exists.
- Pushes the records to Kafka topic `KAFKA_TOPIC`.
