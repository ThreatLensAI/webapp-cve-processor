package main

import (
	"log"

	env "github.com/csye7125-su24-team06/webapp-cve-processor/internal"
	processor "github.com/csye7125-su24-team06/webapp-cve-processor/internal"
)

func main() {
	url := env.GetEnvOrDefault("CVE_LIST_URL", "https://github.com/CVEProject/cvelistV5/archive/refs/heads/main.zip")

	// Setting up Kafka client - Producer
	log.Println("Setting up Kafka client...")
	kafkaClient := processor.NewKafkaProducer()
	defer kafkaClient.Close()

	// Initialize the topic
	log.Println("Initializing Kafka topic...")
	kafkaClient.InitTopic()

	// Process the zip
	log.Println("Processing...")
	processor.Process(url, &kafkaClient)

	log.Println("Done...")
}
